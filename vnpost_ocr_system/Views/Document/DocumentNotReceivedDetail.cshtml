
@{
    ViewBag.Title = "DocumentNotReceivedDetail";
    Layout = "~/Views/Shared/_AdminMasterPage.cshtml";
}


<link href="~/CustomCSS/Document/DocumentNotReceivedDetailController.css" rel="stylesheet" />
<style>
    .swal2-content input {
        display: none !important;
    }

    svg {
        display: none !important;
    }

    #anhgiayhen {
        width: 100%;
        padding-top: 40px;
    }
</style>
<div class="page-titles">
    <div class="d-flex align-items-center">
        <h4 class="font-medium m-b-0 pdleft">Chi tiết giấy hẹn - Chờ tiếp nhận</h4>
    </div>
</div>
<div class="container-fluid">
    <div class="row">
        <div class="col s12">
            <div class="card">
                <div class="form-body">
                    <div class="card-content">
                        <h4 class="font-medium">Thông tin thủ tục</h4>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Mã giấy hẹn:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            #@ViewBag.Order.AppointmentLetterCode
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Tên bưu cục đầu mối:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.PosName
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Tên cơ quan HCC:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.PublicAdministrationName
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Số điện thoại BCDM:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.POPhone
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Tên thủ tục:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.ProfileName
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Địa chỉ BCDM:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.POAddress
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Số điện thoại CQHCC:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.PAPhone
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Địa chỉ CQHCC:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.PAAddress
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                            </div>
                        </div>
                    </div>
                    <div></div>
                    <div class="card-content">
                        <h4 class="font-medium">Thông tin người yêu cầu giải quyết thủ tục hành chính</h4>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Họ và tên:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.ProcedurerFullName
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Số điện thoại
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Địa chỉ:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.ProcedurerStreet
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">

                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Loại GTTT:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.PersonalPaperTypeName
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Số GTTT:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.ProcedurerPersonalPaperNumber
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Ngày cấp:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label" id="ProcedurerPersonalPaperIssuedDate">
                                            @ViewBag.Order.ProcedurerPersonalPaperIssuedDate
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Nơi cấp:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.ProcedurerPersonalPaperIssuedPlace
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div></div>
                    <div class="card-content">
                        <h4 class="font-medium">Thông tin người gửi</h4>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Họ và tên:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.SenderFullName
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Số điện thoại
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.SenderPhone
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Địa chỉ:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.SenderStreet
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">

                                </div>
                            </div>
                        </div>
                    </div>
                    <div></div>
                    <div class="card-content">
                        <h4 class="font-medium">Thông tin người nhận</h4>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Họ và tên:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.ReceiverFullName
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Số điện thoại
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.ReceiverPhone
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4">
                                        <div class="h-form-label">
                                            Địa chỉ:
                                        </div>
                                    </div>
                                    <div class="col s8">
                                        <div class="h-form-label">
                                            @ViewBag.Order.ReceiverStreet
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 l6">
                                <div class="row">
                                    <div class="col s4 m4 l4">
                                        Thông tin ghi chú:
                                    </div>
                                    <div class="col s4">
                                        @ViewBag.Order.OrderNote
                                    </div>
                                </div>
                            </div>
                            <img id="anhgiayhen" src="~/OrderImage/@ViewBag.imageUrl" alt="@ViewBag.imageRUrl"/>
                        </div>
                    </div>
                    <div></div>

                    <div class="card-content form-group">
                        <h4 class="font-medium">Thông tin cập nhật</h4>
                        <div class="row">
                            <div class="col s12 l6">
                                <div class="input-field row">
                                    <p class="col l4 m4 p-t-10 s12 p-t-15">Mã bưu gửi:</p>
                                    <div class="col l6 m6 s12">
                                        <input class="no-border" autocomplete="off" id="con1" type="text" value="" name="itemCode">
                                    </div>
                                </div>
                            </div>
                            <div class="input-field col s12 l6">
                                <div class="row">
                                    <div class="col l4 m4 p-t-10 s12 p-t-15">Trạng thái:</div>
                                    <div class="col l6 m6 s12">
                                        <select tabindex="-1" name="status" id="status" onchange="setItemCode()">
                                            <option value="-2" selected>Đã tiếp nhận</option>
                                            <option value="0">Từ chối </option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row p-t-40">
                            <div class="col s12 l12 ">
                                <div class="row">
                                    <div class="col s4 l2">
                                        Ghi chú:
                                    </div>
                                    <div class="col l6 m6 s12">
                                        <textarea name="note" id="note"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div></div>
                    <div class="card-content">
                        <div class="form-action right-align">
                            <input type="hidden" value="@ViewBag.Order.OrderID" name="id" id="id" />
                            <input type="hidden" value="@ViewBag.letterid" name="letterid" id="letterid" />
                            <button class="my-blue-btn btn" id="update-btn" onclick="update()">Cập nhật</button>
                            <a class="my-blue-btn btn" href="/ho-so/ho-so-cho-nhan">Trở về</a>

                            @*<button class="my-blue-btn btn" formaction="/ho-so/ho-so-da-nhan/chi-tiet">Cập nhật</button>
                                <button class="my-blue-btn btn" formaction="/ho-so/ho-so-cho-nhan">Trở về</button>*@
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<input type="hidden" value="@ViewBag.error" id="err_update" />
<script>
    $(document).ready(function () {
        if (document.getElementById('err_update').value != '') {
            errorAlert('Lỗi', 'Có lỗi xảy ra. Vui lòng thử lại');
        }
    });
    function update() {
        var id = $('#id').val();
        $("#pre-load").show();
        $.ajax({
            url: "/ho-so/ho-so-cho-nhan/chi-tiet/cap-nhat",
            type: "POST",
            datatype: "json",
            data: {
                itemCode: $('#con1').val(),
                status: $('#status').val(),
                note: $('#note').val(),
                id: $('#id').val(),
                letterid: $('#letterid').val()
            },
            success: function (respone) {
                if (respone.message == 'Success') {
                    $("#pre-load").hide();
                    reloadAlert('Cập nhật trạng thái thành công', 3000);
                    window.location.href = "/ho-so/ho-so-da-nhan/chi-tiet?id_raw=" + id;
                } else if (respone.message == 'Detail') {
                    $("#pre-load").hide();
                    errorAlert('Lỗi', 'Mã bưu gửi không tồn tại');
                } else if (respone.message == 'Exist') {
                    $("#pre-load").hide();
                    errorAlert('Lỗi', 'Mã bưu gửi đã đăng kí cho một order khác');
                } else if (respone.message == 'Cancelled') {
                    $("#pre-load").hide();
                    reloadAlert('Cập nhật trạng thái thành công', 3000);
                    window.location.href = "/ho-so/ho-so-da-nhan/chi-tiet?id_raw=" + id;
                } else if (respone.message == 'Changed') {
                    $("#pre-load").hide();
                    errorAlert('Lỗi', 'Trạng thái của đơn hàng này đã bị thay đổi trước đó');
                    setTimeout(() => window.location.href = "/ho-so/ho-so-cho-nhan", 4000)
                    
                }
            }
        })
    }

    function setItemCode() {
        if ($('#status').val() == 0) {
            $('#con1').attr("disabled", true)
        }
        if ($('#status').val() != 0) {
            $('#con1').attr("disabled", false)
        }
    }
</script>
