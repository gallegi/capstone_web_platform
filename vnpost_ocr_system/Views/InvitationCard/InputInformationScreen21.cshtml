
@{
    ViewBag.Title = "InputInformationScreen21";
    Layout = "~/Views/Shared/_MasterPage.cshtml";
}

<script src="~/CustomJS/InputInforScreen21.js"></script>
<link href="~/CustomCSS/InvitationCard/InputInforScreen21.css" rel="stylesheet" />

<link href="~/CustomCSS/InvitationCard/InputInfo.css" rel="stylesheet" />
<link href="~/CustomCSS/preloader/DisplayStatus.css" rel="stylesheet" />

<link href="~/assets/libs/jquery-steps/jquery.steps.css" rel="stylesheet">
<link href="~/assets/libs/jquery-steps/steps.css" rel="stylesheet">
<script src="~/assets/libs/jquery-steps/build/jquery.steps.min.js"></script>

<link href="~/CustomJS/datepicker_src/dist/css/datepicker.min.css" rel="stylesheet" />
<link href="~/CustomJS/datepicker_src/dist/css/custom.css" rel="stylesheet" />
<link href="~/CustomJS/datepicker_src/dist/css/font.css" rel="stylesheet" />

<link href="~/CustomCSS/InvitationCard/InputSenderInfo.css" rel="stylesheet" />
<link href="~/CustomCSS/InvitationCard/InputSenderLib.css" rel="stylesheet" />
<link href="~/CustomCSS/InvitationCard/InputInforScreen22.css" rel="stylesheet" />

<script src="~/CustomJS/InputInfo.js"></script>


<link href="~/assets/libs/toastr/build/toastr.min.css" rel="stylesheet">
<link href="~/assets/uploader/dropzone.min.css" rel="stylesheet" />
<link href="~/assets/uploader/icons.min.css" rel="stylesheet" />

<style>
    .datepicker {
        z-index: 9999;
    }

    #toast-container {
        min-width: 10%;
        top: 0;
        right: 50%;
        transform: translateX(50%) translateY(50%);
    }

    ul.dropdown-content {
        position: fixed !important;
        z-index: 9999;
    }

    .dropzone .dz-preview .dz-image {
        margin: auto;
    }

    .dropzone .dz-preview .dz-progress .dz-upload {
        background: #29bb22 !important;
        background: linear-gradient(to bottom, #7ceb69, #29bb22) !important;
        top: 0;
        bottom: 0;
        width: 0;
    }

    .wizard > .actions {
        padding-top: 30px !important;
    }

    .dz-preview.dz-processing.dz-success.dz-complete.dz-image-preview {
        margin: 0px !important;
        display: block;
    }

    #item5-error {
        color: white;
    }

    .wizard-content .wizard > .steps > ul > li.current .step {
        border-color: #fcaf17 !important;
        background-color: #fff !important;
        color: #fcaf17 !important;
    }

    .wizard-content .wizard > .steps > ul > li.done .step {
        background-color: #fcaf17 !important;
        border-color: #fcaf17 !important;
    }

    .wizard-content .wizard.wizard-circle > .steps > ul > li.current:after, .wizard-content .wizard.wizard-circle > .steps > ul > li.current ~ li:after, .wizard-content .wizard.wizard-circle > .steps > ul > li.current ~ li:before {
        background-color: #F3F3F3 !important;
    }

    .wizard-content .wizard.wizard-circle > .steps > ul > li:after, .wizard-content .wizard.wizard-circle > .steps > ul > li:before {
        background-color: #fcaf17 !important;
    }

    .wizard-content .wizard > .actions > ul > li > a {
        background: #fcaf17 !important;
    }

        .wizard-content .wizard > .actions > ul > li > a[href="#previous"] {
            background-color: #fff !important;
        }

    .summary-label {
        font-weight: bold !important;
    }

    .wizard > .content > .body label[hidden] {
        display: none !important;
    }

    .dropzone .dz-preview:hover .dz-image img {
        -webkit-filter: blur(0px) !important;
        filter: blur(0px) !important;
    }

    .validation {
        color: red;
    }
</style>
<div class="container-fluid">
    <div class="col s12">
        <div class="card">
            <div class="card-content wizard-content">
                <h2 class="card-title">Tạo giấy hẹn mới</h2>
                <form id="myform" action="/giay-hen/trang-thai-giay-hen" method="post" class="validation-wizard wizard-circle m-t-40">
                    <!-- Step 1 -->
                    <h6>Ảnh chụp giấy hẹn</h6>
                    <section>
                        <div class="row">
                            <div class="col s12 l12">
                                <label>Dung lượng tối đa 5Mb <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</label>
                                <div class="input-field center">
                                    <a class="btn waves-effect waves-light bt-color-common" onclick="rotateLeft()"><i class="material-icons">rotate_left</i></a>
                                    <a class="btn waves-effect waves-light bt-color-common" onclick="rotateRight()"><i class="material-icons">rotate_right</i></a>
                                </div>
                                <div action='/' enctype="multipart/form-data" method="post" class="dropzone" id="myAwesomeDropzone">
                                    <div class="fallback">
                                        <input type="file" id="fUpload" class="form-control" single />
                                    </div>
                                    <div class="dz-message needsclick">
                                        <i class="medium material-icons dp48">cloud_upload</i>
                                        <h3 id="title_uploader">Kéo thả file hoặc click vào đây để tải lên</h3>
                                        <span class="text-muted font-13">(File hợp lệ: jpg, png)</span>
                                    </div>
                                </div>
                                <p class="validation" name="item6"></p>
                            </div>
                        </div>
                    </section>
                    <h6>Thông tin thủ tục</h6>
                    <section>
                        <div class="row">
                            <div class="col m6">
                                <div class="input-field col s12">
                                    <select id="item1">
                                        @foreach (vnpost_ocr_system.Models.Province item in ViewBag.Provinces)
                                        {
                                            <option value="@item.PostalProvinceCode">@item.PostalProvinceName</option>
                                        }
                                    </select>
                                    <label for="item1" class="">Tỉnh/Thành phố <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</label>
                                    <p class="validation" name="item1"></p>
                                </div>
                                <div class="input-field col s12">
                                    <select id="item2"></select>
                                    <label for="item2">Quận/Huyện <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</label>
                                    <p class="validation" name="item2"></p>
                                </div>
                                <div class="input-field col s12">
                                    <input type="text" id="item5" class="required" />
                                    <label for="item5">Mã giấy hẹn <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</label>
                                    <p class="validation" name="item5"></p>
                                </div>
                            </div>
                            <div class="col m6">
                                <div class="input-field col s12">
                                    <select id="item3" tabindex="-1"></select>
                                    <label for="item3">Tên CQHC <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</label>
                                    <p class="validation" name="item3"></p>
                                </div>
                                <div class="input-field col s12">
                                    <select id="item4" tabindex="-1"></select>
                                    <label for="item4">Tên thủ tục <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</label>
                                    <p class="validation" name="item4"></p>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!-- Step 2 -->
                    <h6>Thông tin yêu cầu giải quyết TTHC</h6>
                    <section>
                        <div class="row">
                            @if (ViewBag.contactInfos.Count == 0)
                            {
                                <p class="col s12 big-heading m-b-15">
                                    Bạn chưa có thông tin
                                    <a class="modal-trigger light-blue-text hover-underline add" href="#myform1" data-type="1">
                                        Tạo thông tin mới
                                    </a>
                                </p>
                            }
                            else
                            {
                                <p class="col s12 big-heading m-b-15">Chọn thông tin có sẵn bên dưới:</p>
                                foreach (vnpost_ocr_system.Models.ContactInfoDB item in ViewBag.contactInfos)
                                {
                                    <div class="contact1 info-list-div col s12">
                                        <div class="col s8 m8 l8">
                                            <p class="FullName content-text highlight col s12">@item.FullName</p>
                                            <p class="content-text col s12"><span class="Street">@item.Street</span>, <span data-district="@item.PostalDistrictCode" class="Address">@(item.PostalDistrictName), @item.PostalProvinceName</span></p>
                                            <p class="content-text col s12">Số điện thoại: <span class="Phone">@item.Phone</span></p>
                                            <p class="content-text col s12">Loại giấy tờ tùy thân: <span data-papertype="@(item.PersonalPaperTypeID == null ? -1 : (int?)item.PersonalPaperTypeID)" class="PersonalPaperTypeName">@item.PersonalPaperTypeName</span></p>
                                            <p class="content-text col s12">Số giấy tờ tùy thân: <span class="PersonalPaperNumber">@item.PersonalPaperNumber</span></p>
                                            <p class="content-text col s12">Ngày cấp: <span class="PersonalPaperIssuedDate">@(item.PersonalPaperIssuedDate == null ? "" : item.PersonalPaperIssuedDate.GetValueOrDefault().ToString("dd/MM/yyyy"))</span></p>
                                            <p class="content-text col s12">Nơi cấp: <span class="PersonalPaperIssuedPlace">@(item.PersonalPaperIssuedPlace == null ? "" : item.PersonalPaperIssuedPlace)</span></p>
                                        </div>
                                        <div class="col l4 s4 m4 is-check-contact-type-1" id="isCheckContactType1-@item.ContactInfoID">
                                        </div>
                                        <div class="col s12 m-t-10">
                                            <div class="col p-t-10">
                                                <a class="btn waves-effect waves-light bt-color-common contactInfoType1" data-contactinfoid="@item.ContactInfoID">Sử dụng thông tin này</a>
                                            </div>
                                            <div class="col p-t-10">
                                                <a class="modal-trigger btn waves-effect waves-light bt-color-common edit" data-contactinfoid="@item.ContactInfoID" data-type="1" href="#myform1">Chỉnh sửa</a>
                                            </div>
                                        </div>
                                    </div>
                                }
                                <p class="col s12 big-heading m-b-15">
                                    Bạn muốn sử dụng thông tin khác?
                                    <a class="modal-trigger light-blue-text hover-underline add" href="#myform1" data-type="1">
                                        Nhập thông tin mới
                                    </a>
                                </p>
                            }
                        </div>
                    </section>
                    <!-- Step 3 -->
                    <h6>Thông tin người gửi</h6>
                    <section>
                        <div class="row">
                            @if (ViewBag.contactInfos.Count == 0)
                            {
                                <p class="col s12 big-heading m-b-15">
                                    Bạn chưa có thông tin
                                    <a class="modal-trigger light-blue-text hover-underline add" href="#myform1" data-type="2">
                                        Tạo thông tin mới
                                    </a>
                                </p>
                            }
                            else
                            {
                                <p class="col s12 big-heading m-b-15">Chọn thông tin có sẵn bên dưới:</p>
                                foreach (vnpost_ocr_system.Models.ContactInfoDB item in ViewBag.contactInfos)
                                {
                                    <div class="contact2 info-list-div col s12">
                                        <div class="col l8 m8 s8">
                                            <p class="FullName content-text highlight col s12">@item.FullName</p>
                                            <p class="content-text col s12"><span class="Street">@item.Street</span>, <span data-district="@item.PostalDistrictCode" class="Address">@(item.PostalDistrictName), @item.PostalProvinceName</span></p>
                                            <p class="content-text col s12">Số điện thoại: <span class="Phone">@item.Phone</span></p>
                                        </div>
                                        <div class="col l4 m4 s4 is-check-contact-type-2" id="isCheckContactType2-@item.ContactInfoID">
                                        </div>
                                        <div class="col s12 m-t-10">
                                            <div class="col p-t-10">
                                                <a class="btn waves-effect waves-light bt-color-common contactInfoType2" data-contactinfoid="@item.ContactInfoID">Sử dụng thông tin này</a>
                                            </div>
                                            <div class="col p-t-10">
                                                <a class="modal-trigger btn waves-effect waves-light bt-color-common edit" data-contactinfoid="@item.ContactInfoID" data-type="2" href="#myform1">Chỉnh sửa</a>
                                            </div>
                                        </div>
                                    </div>
                                }
                                <p class="col s12 big-heading m-b-15">
                                    Bạn muốn sử dụng thông tin khác?
                                    <a class="modal-trigger light-blue-text hover-underline add" href="#myform1" data-type="2">
                                        Nhập thông tin mới
                                    </a>
                                </p>
                            }
                        </div>
                    </section>
                    <!-- Step 4 -->
                    <h6>Thông tin người nhận</h6>
                    <section>
                        <div class="row">
                            @if (ViewBag.contactInfos.Count == 0)
                            {
                                <p class="col s12 big-heading m-b-15">
                                    Bạn chưa có thông tin
                                    <a class="modal-trigger light-blue-text hover-underline add" href="#myform1" data-type="3">
                                        Tạo thông tin mới
                                    </a>
                                </p>
                            }
                            else
                            {
                                <p class="col s12 big-heading m-b-15">Chọn thông tin có sẵn bên dưới:</p>
                                foreach (vnpost_ocr_system.Models.ContactInfoDB item in ViewBag.contactInfos)
                                {
                                    <div class="contact3 info-list-div col s12">
                                        <div class="col l8 s8 m8">
                                            <p class="FullName content-text highlight col s12">@item.FullName</p>
                                            <p class="content-text col s12"><span class="Street">@item.Street</span>, <span data-district="@item.PostalDistrictCode" class="Address">@(item.PostalDistrictName), @item.PostalProvinceName</span></p>
                                            <p class="content-text col s12">Số điện thoại: <span class="Phone">@item.Phone</span></p>
                                        </div>
                                        <div class="col l4 s4 m4 is-check-contact-type-3" id="isCheckContactType3-@item.ContactInfoID">
                                        </div>
                                        <div class="col s12 m-t-10">
                                            <div class="col p-t-10">
                                                <a class="btn waves-effect waves-light bt-color-common contactInfoType3" data-contactinfoid="@item.ContactInfoID">Sử dụng thông tin này</a>
                                            </div>
                                            <div class="col p-t-10">
                                                <a class="modal-trigger btn waves-effect waves-light bt-color-common edit" data-contactinfoid="@item.ContactInfoID" data-type="3" href="#myform1">Chỉnh sửa</a>
                                            </div>
                                        </div>
                                    </div>
                                }
                                <p class="col s12 big-heading m-b-15">
                                    Bạn muốn sử dụng thông tin khác?
                                    <a class="modal-trigger light-blue-text hover-underline add" href="#myform1" data-type="3">
                                        Nhập thông tin mới
                                    </a>
                                </p>
                            }
                        </div>
                    </section>
                    <!-- Step 5 -->
                    <h6>Xác nhận hồ sơ</h6>
                    <section>
                        <div class="row">
                            <div class="form-body">
                                <div class="card-content col s12">
                                    <h4 class="font-medium">Thông tin thủ tục</h4>
                                    <hr />
                                    <div class="row">
                                        <div class="col s12 l6">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Tên thủ tục:</label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label class="ProfileName summary-content"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col s12 l6">
                                            <div class="row clgray">
                                                <div class="col s3">
                                                    <div class="h-form-label">
                                                        <label class="summary-label">Tên cơ quan HCC: </label>
                                                    </div>
                                                </div>
                                                <div class="col s9">
                                                    <div class="h-form-label summary-content">
                                                        <label id="AdminName"></label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col s12 l6">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Tỉnh/Thành phố:</label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label summary-content">
                                                    <label id="PostalProvinceName">@ViewBag.Provinces[0].PostalProvinceName</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col s12 l6">
                                            <div class="row clgray">
                                                <div class="col s3">
                                                    <div class="h-form-label">
                                                        <label class="summary-label">Địa chỉ CQHCC:</label>
                                                    </div>
                                                </div>
                                                <div class="col s9">
                                                    <div class="h-form-label">
                                                        <label id="PA_Address"></label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col s12 l6">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Quận/Huyện: </label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label summary-content">
                                                    <label id="PostalDistrictName"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col s12 l6">
                                            <div class="row clgray">
                                                <div class="col s3">
                                                    <div class="h-form-label">
                                                        <label class="summary-label">Mã giấy hẹn:</label>
                                                    </div>
                                                </div>
                                                <div class="col s9">
                                                    <div class="h-form-label summary-content">
                                                        <label class="AppointmentLetterCode"></label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col s12">
                                            <div class="col h-form-label">
                                                <label class="summary-label">Ảnh giấy hẹn: </label>
                                            </div>
                                        </div>
                                        <div class="col s12 center">
                                            <div class="h-form-label" id="img">
                                                <img id="c" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-content col s12">
                                    <h4 class="font-medium">Thông tin người yêu cầu giải quyết thủ tục hành chính</h4>
                                    <hr />
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Họ và tên:</label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="ProcedurerFullName"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Số điện thoại</label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="ProcedurerPhone"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Địa chỉ: </label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label><span id="ProcedurerStreet"></span>, <span id="ProcedurerAddress"></span></label>
                                                    <label hidden id="ProcedurerPostalDistrictCode"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Loại GTTT: </label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="ProcedurerPersonalPaperTypeName"></label>
                                                    <label hidden id="ProcedurerPersonalPaperTypeID"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Số GTTT: </label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="ProcedurerPersonalPaperNumber"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Ngày cấp: </label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="ProcedurerPersonalPaperIssuedDate"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Nơi cấp: </label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="ProcedurerPersonalPaperIssuedPlace"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-content col s12">
                                    <h4 class="font-medium">Thông tin người gửi</h4>
                                    <hr />
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Họ và tên:</label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="SenderFullName"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Số điện thoại</label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="SenderPhone"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Địa chỉ: </label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label><span id="SenderStreet"></span>, <span id="SenderAddress"></span></label>
                                                    <label hidden id="SenderPostalDistrictCode"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-content col s12">
                                    <h4 class="font-medium">Thông tin người nhận</h4>
                                    <hr />
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Họ và tên:</label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label class="ReceiverFullName"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Số điện thoại</label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label id="ReceiverPhone"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12 l6">
                                        <div class="row clgray">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Địa chỉ: </label>
                                                </div>
                                            </div>
                                            <div class="col s9">
                                                <div class="h-form-label">
                                                    <label><span class="ReceiverStreet"></span>, <span class="ReceiverAddress"></span></label>
                                                    <label hidden id="ReceiverPostalDistrictCode"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col s12">
                                        <div class="row clgray">
                                            <div class="col s12">
                                                <div class="h-form-label">
                                                    <label class="summary-label">Ghi chú:</label>
                                                </div>
                                            </div>
                                            <div class="col s12">
                                                <textarea id="OrderNote"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!-- Step 6 -->
                    <h6>Xác nhận thanh toán</h6>
                    <section>
                        <div class="row">
                            <h4>Hình thức thanh toán</h4>
                            <div class="col l9 s12">
                                <div class="card card-shadow p-20 resize-card">
                                    <div>
                                        <label>
                                            <input id="r1" type="radio" checked />
                                            <span>Thanh toán tiền mặt khi nhận hàng</span>
                                        </label><br />
                                        <label>
                                            <input id="r2" type="radio" disabled />
                                            <span>Thanh toán bằng thẻ quốc tế Visa, Master, JCB</span>
                                        </label><br />
                                        <label>
                                            <input id="r3" type="radio" disabled />
                                            <span>Thẻ ATM nội địa/Internet Banking</span>
                                        </label><br />
                                    </div>
                                </div>
                            </div>

                            <div class="col l3">
                                <div class="row">
                                    <div class="card card-shadow p-20">
                                        <div>
                                            <p class="payment-title card-border">Địa chỉ đơn hàng</p>
                                        </div>

                                        <b class="payment-title ReceiverFullName"></b>
                                        <div>
                                            <p>
                                                <span class="ReceiverStreet"></span>, <span class="ReceiverAddress"></span>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="card card-shadow p-20">
                                        <div>
                                            <p class="payment-title card-border">Đơn hàng</p>
                                        </div>
                                        <div>
                                            <b class="payment-title m-b-25">Mã hồ sơ: <span class="AppointmentLetterCode"></span></b>
                                        </div>
                                        <span>
                                            <span class="payment-title">Thủ tục hành chính:</span>
                                            <span class="ProfileName"></span>
                                        </span>


                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <input name="id" id="id_raw" readonly hidden />
                </form>
            </div>
        </div>
    </div>
</div>

<div id="myform1" class="modal fade">
    <div class="form-wrapper">
        <div class="row">
            <div class="input-field col s12">
                <div class="select-wrapper row">
                    <p class="col l3 m3 p-t-10 s12">Họ và tên <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</p>
                    <div class="col l9 m9 s12">
                        <input required id="name_edit" type="text">
                        <p class="validation" name="name_edit"></p>
                    </div>
                </div>
            </div>
            <div class="input-field col s12">
                <div class="select-wrapper row">
                    <p class="col l3 m3 p-t-10 s12">Số điện thoại <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</p>
                    <div class="col l9 m9 s12">
                        <input id="phone_edit" type="text">
                        <p class="validation" name="phone_edit"></p>
                    </div>
                </div>
            </div>
            <div class="input-field col s12">
                <div class="select-wrapper row">
                    <p class="col l3 m3 p-t-10 s12 ">Tỉnh/Thành phố <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</p>
                    <div class="col l9 m9 s12">
                        <select required tabindex="-1" id="province_edit" class="card-border">
                            @foreach (vnpost_ocr_system.Models.Province item in ViewBag.Provinces)
                            {
                                <option value="@item.PostalProvinceCode">@item.PostalProvinceName</option>
                            }
                        </select>
                    </div>
                </div>
            </div>
            <div class="input-field col s12">
                <div class="select-wrapper row">
                    <div class="col l3 m3 p-t-10 s12 ">Quận/Huyện <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</div>
                    <div class="col l9 m9 s12">
                        <select required tabindex="-1" id="district_edit" class="card-border">
                            @ViewBag.select
                        </select>
                        <p class="validation" name="district_edit"></p>
                    </div>
                </div>
            </div>
            <div class="input-field col s12">
                <div class="select-wrapper row">
                    <div class="col l3 m3 p-t-10 s12 ">Địa chỉ <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</div>
                    <div class="col l9 m9 s12">
                        <textarea required id="street_edit"></textarea>
                        <p class="validation" name="street_edit"></p>
                    </div>
                </div>
            </div>
            <div id="showmore">
                <div class="input-field col s12">
                    <div class="select-wrapper row">
                        <div class="col l3 m3 p-t-10 s12 ">Loại giấy tờ tùy thân <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</div>
                        <div class="col l9 m9 s12">
                            <select tabindex="-1" id="paper_type_edit" class="card-border">
                                @foreach (vnpost_ocr_system.Models.PersonalPaperType item in ViewBag.papertypes)
                                {
                                    <option value="@item.PersonalPaperTypeID">@item.PersonalPaperTypeName</option>
                                }
                            </select>
                        </div>
                    </div>
                </div>
                <div class="input-field col s12">
                    <div class="input-field row">
                        <p class="col l3 m3 p-t-10 s12">Số giấy tờ tùy thân <i class="fa fa-asterisk" style="font-size:10px;color:red"></i> :</p>
                        <div class="col l9 m9 s12">
                            <input id="paper_number_edit" type="text">
                            <p class="validation" name="paper_number_edit"></p>
                        </div>
                    </div>
                </div>
                <div class="input-field col s12">
                    <div class="input-field row">
                        <p class="col l3 m3 p-t-10 s12">Ngày cấp:</p>
                        <div class="col l9 m9 s12 datepicker-calendar-container row">
                            <input name="dateTLHD" id="paper_date_edit" type='text' readonly
                                   class="col s10 l10 datepicker-here" autocomplete="off"
                                   data-language='vi' />
                            <i id="picker-icon" class="unselectable material-icons dp48 small p-0-0 col hover-default">date_range</i>
                        </div>
                    </div>
                </div>
                <div class="input-field col s12">
                    <div class="input-field row">
                        <p class="col l3 m3 p-t-10 s12">Nơi cấp:</p>
                        <div class="col l9 m9 s12">
                            <input id="paper_place_edit" type="text">
                            <input hidden readonly id="info_edit" type="text" />
                            <input hidden readonly id="type" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="input-field col s12">
                <div class="select-wrapper row m-b-20">
                    <div class="col l2 m2 p-t-10 s12 "></div>
                    <div class="col l8 m8 s12">
                        <a class="col l5 s12 btn waves-effect waves-light bt-color-common" id="save_contact_info">Lưu</a>
                        <button class="col offset-l2 l5 s12 btn waves-effect waves-light bt-color-common modal-close" id="close-modal">Hủy Bỏ</button>
                    </div>
                    <div class="col l2 m2 p-t-10 s12 "></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/Scripts/jquery.cookie.js"></script>
<script src="~/assets/libs/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/assets/extra-libs/prism/prism.js"></script>
<script src="~/assets/uploader/dropzoneMultiple.js"></script>

<script>
    var UserInvitation = {}
    var CreateInvitation = {}
    var OCRResult = {}
    var ImageData = null;
    var _currentIndex = -1;
    var _newIndex = -1;

    if (!!$.cookie('CreateInvitation')) {
        CreateInvitation = JSON.parse($.cookie('CreateInvitation'))
        var UserProvinceCode = CreateInvitation.UserProvinceCode
        var UserDistrictsID = CreateInvitation.PostalDistrictCode
        var UserAdminLocationID = CreateInvitation.UserAdminLocationID
        var UserProfileID = CreateInvitation.UserProfileID
    } else {
        var UserProvinceCode = @ViewBag.UserProvinceCode;
        var UserDistrictsID = @ViewBag.UserDistrictsID;
        var UserAdminLocationID = ""
        var UserProfileID = ""
    }


    var dist = '@Html.Raw(ViewBag.select)'
    var type = "";
    var validate1 = false;
    var validate2 = false;
    var validate3 = false;

    var data1 = new FormData();

    function getDistrict(OCRResult) {
        $('#pre-load').show()
        $('#item2').empty();
        $('#item2').formSelect();
        $('#item3').empty();
        $('#item3').formSelect();
        $('#item4').empty();
        $('#item4').formSelect();
        $('#PostalProvinceName').text($('#item1').find("option:selected").text())
        $.ajax({
            type: "POST",
            url: "/GetDistrict",
            cache: false,
            dataType: 'json',
            data: {
                PostalProvinceCode: $('#item1').val()
            },
            success: function (response) {
                var option = "";
                for (var i = 0; i < response.length; i++) {
                    if (i === 0)
                        $("#PostalDistrictName").text(response[i].ProfileName)
                    option += "<option value='" + response[i].PostalDistrictCode + "'>" + response[i].PostalDistrictName + "</option>";
                }
                $('#item2').append(option);
                if (OCRResult != null && OCRResult.PostalDistrictCode != null) {
                    $('#item2').val(OCRResult.PostalDistrictCode);
                }
                $('#item2').formSelect();
                if ($('#item2').val() != null)
                    $('p[name="item2"]').text("")
                if (OCRResult != null) {
                    getAdmins(OCRResult)
                } else {
                    $('#pre-load').hide()
                }
            },
            error: function () {
                $('#pre-load').hide()
            }
        })
    }

    function getAdmins(OCRResult) {
        $('#pre-load').show()
        $('#item3').empty();
        $('#item3').formSelect();
        $('#item4').empty();
        $('#item4').formSelect();
        $('#PostalDistrictName').text($('#item2').find('option:selected').text());
        $.ajax({
            type: "POST",
            url: "/GetPublicAdministration",
            cache: false,
            dataType: 'json',
            data: {
                PostalDistrictCode: $('#item2').val()
            },
            success: function (response) {
                var option = "";
                for (var i = 0; i < response.length; i++) {
                    if (i === 0)
                        $("#AdminName").text(response[i].ProfileName)
                    option += "<option data-address='" + response[i].Address + "' value='" + response[i].PublicAdministrationLocationID + "'>" + response[i].PublicAdministrationName + "</option>";
                }
                $('#item3').append(option);
                if (OCRResult != null && OCRResult.PublicAdministrationLocationID != null) {
                    $('#item3').val(OCRResult.PublicAdministrationLocationID)
                }
                $('#item3').formSelect();
                if ($('#item3').val() != null)
                    $('p[name="item3"]').text("")
                if (OCRResult != null) {
                    getProfiles(OCRResult);
                } else {
                    $('#pre-load').hide()
                }
            },
            error: function () {
                $('#pre-load').hide()
            }
        })
    }

    function getProfiles(OCRResult) {
        $('#pre-load').show()
        $('#item4').empty();
        $('#item4').formSelect();
        $("#AdminName").text($('#item3').find('option:selected').text());
        $('#PA_Address').text($('#item3').find('option:selected').data("address"))
        $.ajax({
            type: "POST",
            url: "/GetProfile",
            cache: false,
            dataType: 'json',
            data: {
                PublicAdministrationLocationID: $('#item3').val()
            },
            success: function (response) {
                var option = "";
                for (var i = 0; i < response.length; i++) {
                    if (i === 0)
                        $(".ProfileName").text(response[i].ProfileName)
                    option += "<option value='" + response[i].ProfileID + "'>" + response[i].ProfileName + "</option>";
                }
                $('#item4').append(option);
                if (OCRResult != null && OCRResult.ProfileID != null) {
                    $('#item4').val(OCRResult.ProfileID)
                }
                $('#item4').formSelect();
                if ($('#item4').val() != null)
                    $('p[name="item4"]').text("")
                $('#pre-load').hide()
            },
            error: function () {
                $('#pre-load').hide()
            }
        })
    }

    $(document).ready(function () {
        if (UserProvinceCode != "") {
            $('#item1').val(UserProvinceCode)
            $('#item1').formSelect()
        }
        if (CreateInvitation.UserLetterCode !== undefined) {
            $('#item5').val(CreateInvitation.UserLetterCode)
            $('.AppointmentLetterCode').text(CreateInvitation.UserLetterCode)
            $('#item5').focus()
        }
        if (CreateInvitation.UserOrderNote !== undefined) {
            $('#OrderNote').val(CreateInvitation.UserOrderNote)
        }

        $('#item1').change(function () {
            getDistrict(null);
        })

        $('#item2').change(function () {
            $('#pre-load').show()
            getAdmins(null);
        })

        $('#item3').change(function () {
            getProfiles(null);
        })

        $('#item4').change(function () {
            $(".ProfileName").text($(this).find('option:selected').text());
        })

        $('#item5').change(function () {
            $('.AppointmentLetterCode').text($(item5).val())
        })
    })


    //Clear form 1 before add or edit data
    $(document).on("click", ".modal-trigger", function () {
        $('#myform1').find("input[type=text], textarea").val("");
        $('#paper_type_edit').val(null);
        $('#paper_type_edit').formSelect()
        $('#province_edit').val(null);
        $('#province_edit').formSelect()
        $('#district_edit').empty()
        $('#district_edit').append(dist)
        $('#district_edit').formSelect()
    })

    function getSuitableCode(priorityCode, firstScreenCode, firstLeft, secondLeft) {
        if (priorityCode != null) {
            return priorityCode;
        }
        if (firstLeft != null) {
            return firstLeft;
        }
        if (secondLeft != null) {
            return secondLeft;
        }
        if (firstScreenCode != null) {
            return firstScreenCode;
        }
        return null;
    }

    function getSuitableString(priorityString, firstLeft, secondLeft) {
        if (priorityString != null) {
            return priorityString;
        }
        if (firstLeft != null) {
            return firstLeft;
        }
        if (secondLeft != null) {
            return secondLeft;
        }
    }

    $(document).on("click", ".add", function () {
        type = $(this).data("type");
        $('p[name="name_edit"]').text("")
        $('p[name="phone_edit"]').text("")
        $('p[name="district_edit"]').text("")
        $('p[name="street_edit"]').text("")
        $('p[name="paper_number_edit"]').text("")
        if (type != 1) $('#showmore').hide();
        else $('#showmore').show();
        console.log(OCRResult)
        if (!$.isEmptyObject(OCRResult)) {
            console.log(_newIndex);
            if (_newIndex == 2) {
                $('input#name_edit').val(
                    getSuitableString(OCRResult.ProcedurerFullName, OCRResult.SenderFullName, OCRResult.ReceiverFullName))
                $('input#phone_edit').val(
                    getSuitableString(OCRResult.ProcedurerPhone, OCRResult.SenderPhone, OCRResult.ReceiverPhone))

                //Province
                ProcedurerProvincePostalCode = getSuitableCode(OCRResult.ProcedurerProvincePostalCode,
                    $('#item1').find("option:selected").val(), OCRResult.SenderProvincePostalCode, OCRResult.ReceiverProvincePostalCode)
                if (ProcedurerProvincePostalCode != null) {
                    $('#province_edit').val(ProcedurerProvincePostalCode);
                    $('#province_edit').formSelect()
                    //District
                    ProcedurerDistrictPostalCode = getSuitableCode(OCRResult.ProcedurerDistrictPostalCode,
                        $('#item2').find("option:selected").val(), OCRResult.SenderDistrictPostalCode, OCRResult.ReceiverDistrictPostalCode)
                    selectDistrict(ProcedurerDistrictPostalCode);
                }

                //Street
                $('#street_edit').val(
                    getSuitableString(OCRResult.ProcedurerStreet, OCRResult.SenderStreet, OCRResult.ReceiverStreet));
                $('#paper_type_edit').val(OCRResult.ProcedurerPersonalPaperType);
                $('#paper_type_edit').formSelect();
                $('#paper_number_edit').val(OCRResult.ProcedurerPersonalPaperNumber);
                $('#paper_date_edit').val(OCRResult.ProcedurerPersonalPaperIssuedDate);
                $('#paper_place_edit').val(OCRResult.ProcedurerPersonalPaperIssuedPlace);
            } else if (_newIndex == 3) {
                $('input#name_edit').val(
                    getSuitableString(OCRResult.SenderFullName, OCRResult.ProcedurerFullName, OCRResult.ReceiverFullName))
                $('input#phone_edit').val(
                    getSuitableString(OCRResult.SenderPhone, OCRResult.ProcedurerPhone, OCRResult.ReceiverPhone))

                //Province
                SenderProvincePostalCode = getSuitableCode(OCRResult.SenderProvincePostalCode,
                    $('#item1').find("option:selected").val(), OCRResult.ProcedurerProvincePostalCode, OCRResult.ReceiverProvincePostalCode)
                if (SenderProvincePostalCode != null) {
                    $('#province_edit').val(SenderProvincePostalCode);
                    $('#province_edit').formSelect()
                    //District
                    SenderDistrictPostalCode = getSuitableCode(OCRResult.SenderDistrictPostalCode,
                        $('#item2').find("option:selected").val(), OCRResult.ProcedurerDistrictPostalCode, OCRResult.ReceiverDistrictPostalCode)
                    selectDistrict(SenderDistrictPostalCode);
                }

                //Street
                $('#street_edit').val(
                    getSuitableString(OCRResult.SenderStreet, OCRResult.ProcedurerStreet, OCRResult.ReceiverStreet));

            } else if (_newIndex == 4) {
                $('input#name_edit').val(
                    getSuitableString(OCRResult.ReceiverFullName, OCRResult.ProcedurerFullName, OCRResult.SenderFullName))
                $('input#phone_edit').val(
                    getSuitableString(OCRResult.ReceiverPhone, OCRResult.ProcedurerPhone, OCRResult.SenderPhone))

                //Province
                ReceiverProvincePostalCode = getSuitableCode(OCRResult.ReceiverProvincePostalCode,
                    $('#item1').find("option:selected").val(), OCRResult.ProcedurerProvincePostalCode, OCRResult.SenderProvincePostalCode)
                if (ReceiverProvincePostalCode != null) {
                    $('#province_edit').val(ReceiverProvincePostalCode);
                    $('#province_edit').formSelect()
                //District
                    ReceiverDistrictPostalCode = getSuitableCode(OCRResult.ReceiverDistrictPostalCode,
                        $('#item2').find("option:selected").val(), OCRResult.ProcedurerDistrictPostalCode, OCRResult.SenderDistrictPostalCode)
                    selectDistrict(ReceiverDistrictPostalCode);
                }
                //Street
                $('#street_edit').val(
                    getSuitableString(OCRResult.ReceiverStreet, OCRResult.ProcedurerStreet, OCRResult.SenderStreet));
            }
        }
    })

    $(document).on("click", ".edit", function () {
        $('p[name="name_edit"]').text("")
        $('p[name="phone_edit"]').text("")
        $('p[name="district_edit"]').text("")
        $('p[name="street_edit"]').text("")
        $('p[name="paper_number_edit"]').text("")
        $('#pre-load').show()
        type = $(this).data("type");
        if (type != 1) $('#showmore').hide();
        else $('#showmore').show();
        $.ajax({
            type: "POST",
            url: "/giay-hen/nhap-giay-hen/thong-tin-thu-tuc/GetContactInfo",
            cache: false,
            dataType: "json",
            data: {
                id: $(this).data("contactinfoid"),
                type: type
            },
            success: function (response) {
                $('#name_edit').val(response.info.FullName);
                $('#phone_edit').val(response.info.Phone);
                $('#province_edit').val(response.info.PostalProvinceCode);
                $('#province_edit').formSelect();
                $('#district_edit').empty();
                var option = "";
                for (var i = 0; i < response.list.length; i++) {
                    option += "<option value='" + response.list[i].PostalDistrictCode + "'>" + response.list[i].PostalDistrictName + "</option>";
                }
                $('#district_edit').html(option);
                $('#district_edit').val(response.info.PostalDistrictCode);
                $('#district_edit').formSelect();
                $('#street_edit').val(response.info.Street);
                $('#paper_type_edit').val(response.info.PersonalPaperTypeID == null ? "-1" : response.info.PersonalPaperTypeID)
                $('#paper_type_edit').formSelect();
                $('#paper_number_edit').val(response.info.PersonalPaperNumber);
                $('#paper_date_edit').val(response.info.PersonalPaperIssuedDateString);
                $('#paper_place_edit').val(response.info.PersonalPaperIssuedPlace);
                $('#info_edit').val(response.info.ContactInfoID);
                $('#pre-load').hide()
            },
            error: function () {
                $('#pre-load').hide()
            }
        })
    })

    function selectProvinceDistrict(data) {
        if (data != null) {

        }
    }

    function selectDistrict(DistrictPostalCode){
        $('#pre-load').show()
        $.ajax({
            type: "POST",
            url: "/GetDistrict",
            cache: false,
            dataType: 'json',
            data: {
                PostalProvinceCode: $('#province_edit').val()
            },
            success: function (response) {
                $('#district_edit').empty();
                var option = "";
                for (var i = 0; i < response.length; i++) {
                    option += "<option value='" + response[i].PostalDistrictCode + "'>" + response[i].PostalDistrictName + "</option>";
                }
                $('#district_edit').append(option);
                if (DistrictPostalCode != null) {
                    $('#district_edit').val(DistrictPostalCode)
                }
                $('#district_edit').formSelect();
                $('#pre-load').hide()
            },
            error: function () {
                $('#pre-load').hide()
            }
        })
    }

    $('#province_edit').change(function () {
        selectDistrict(null)
    })

    var contact = "";

    $("#phone_edit").keydown(function (e) {
        var arr = [];
        for (var i = 96; i <= 105; i++) {
            arr.push(i);
        }
        for (var i = 48; i <= 57; i++) {
            arr.push(i);
        }
        arr.push(8);
        if (arr.indexOf(e.keyCode) == -1 || ($(this).val().length >= 10 && e.keyCode!=8)) {
            e.preventDefault();
        }
    });

    $(document).on("click", 'section [class^=contact]', function () {
        contact = 'section [class^=contact]:nth-child(' + ($(this).index() + 1) + ')';
    })

    $(document).on("click", "#save_contact_info", function () {
        var check = true;
        if ($('#name_edit').val().trim() == "") {
            $('p[name="name_edit"]').text("Vui lòng nhập Họ và tên")
            check = false;
        }
        else {
            $('p[name="name_edit"]').text("")
        }
        var patt1 = new RegExp("^0[35789]\\d{8}$");
        if (!patt1.test($('#phone_edit').val().trim())) {
            $('p[name="phone_edit"]').text("Số điện thoại không hợp lệ")
            check = false;
        }
        else {
            $('p[name="phone_edit"]').text("")
        }
        if ($('#province_edit').val() == null || $('#district_edit').val() == null) {
            $('p[name="district_edit"]').text("Vui lòng chọn Quận/Huyện");
            check = false;
        }
        else {
            $('p[name="district_edit"]').text("")
        }
        if ($('#street_edit').val().trim() == "") {
            $('p[name="street_edit"]').text("Vui lòng nhập Địa chỉ")
            check = false;
        }
        else {
            $('p[name="street_edit"]').text("")
        }
        if (type == 1 && $('#paper_number_edit').val().trim() == "") {
            $('p[name="paper_number_edit"]').text("Vui lòng nhập Số giấy tờ tùy thân")
            check = false;
        }
        else {
            $('p[name="paper_number_edit"]').text("")
        }
        if (check === false)
            return;
        else {
            $('#pre-load').show()
            $.ajax({
                type: "POST",
                url: "/giay-hen/nhap-giay-hen/thong-tin-thu-tuc/Add",
                cache: false,
                dataType: "json",
                data: {
                    FullName: $('#name_edit').val(),
                    Phone: $('#phone_edit').val(),
                    PostalDistrictCode: $('#district_edit').val(),
                    Street: $('#street_edit').val(),
                    PersonalPaperTypeID: $('#paper_type_edit').val(),
                    PersonalPaperNumber: $('#paper_number_edit').val(),
                    PersonalPaperIssuedDateString: $('#paper_date_edit').val(),
                    PersonalPaperIssuedPlace: $('#paper_place_edit').val(),
                    ContactInfoID: $('#info_edit').val(),
                    Type: type
                },
                success: function (response) {
                    if (response.success) {
                        if (response.add) {
                            console.log(response)
                            $('.contact1:last').after(response.html[0]);
                            $('.contact2:last').after(response.html[1]);
                            $('.contact3:last').after(response.html[2]);
                        }
                        else {
                            $(contact).find('.FullName').text($('#name_edit').val())
                            $(contact).find('.Street').text($('#street_edit').val())
                            $(contact).find('.Address').text($('#district_edit option:selected').text() + ", " + $('#province_edit option:selected').text())
                            $(contact).find('.Address').data('district', $('#district_edit').val())
                            $(contact).find('.Phone').text($('#phone_edit').val())
                            $(contact).find('.PersonalPaperTypeName').text($('#paper_type_edit option:selected').text())
                            $(contact).find('.PersonalPaperTypeName').data('papertype', $('#paper_type_edit').val())
                            $(contact).find('.PersonalPaperNumber').text($('#paper_number_edit').val())
                            $(contact).find('.PersonalPaperIssuedDate').text($('#paper_date_edit').val())
                            $(contact).find('.PersonalPaperIssuedPlace').text($('#paper_place_edit').val())
                        }
                        $('#close-modal').click();
                        successAlert(response.message);
                    }
                    else
                        errorAlert(response.message)
                    $('#pre-load').hide()
                },
                error: function () {
                    $('#pre-load').hide()
                }
            })
        }
    })

    $(document).on("click", ".contactInfoType1", function () {
        var Adminprofile = $(this).closest('.contact1');
        if (Adminprofile.find('.PersonalPaperTypeName').text() == "" || Adminprofile.find('.PersonalPaperNumber').text() == "") {
            toastr.error("Xin hãy cập nhật đầy đủ thông tin trước khi chọn");
            return;
        }
        $('#ProcedurerFullName').text(Adminprofile.find('.FullName').text());
        $('#ProcedurerPhone').text(Adminprofile.find('.Phone').text());
        $('#ProcedurerStreet').text(Adminprofile.find('.Street').text());
        $('#ProcedurerAddress').text(Adminprofile.find('.Address').text());
        $('#ProcedurerPostalDistrictCode').text(Adminprofile.find('.Address').data("district"));
        $('#ProcedurerPersonalPaperTypeName').text(Adminprofile.find('.PersonalPaperTypeName').text());
        $('#ProcedurerPersonalPaperTypeID').text(Adminprofile.find('.PersonalPaperTypeName').data("papertype"));
        $('#ProcedurerPersonalPaperNumber').text(Adminprofile.find('.PersonalPaperNumber').text());
        $('#ProcedurerPersonalPaperIssuedDate').text(Adminprofile.find('.PersonalPaperIssuedDate').text());
        $('#ProcedurerPersonalPaperIssuedPlace').text(Adminprofile.find('.PersonalPaperIssuedPlace').text());
        var a = $('#isCheckContactType1-' + $(this).attr('data-contactinfoid'));
        $(".is-check-contact-type-1").empty();
        validate1 = true;
        a.append("<i class=\"material-icons dp48 right\" style=\"font-size:35px;right:0px;vertical-align: middle;color: #7abd7a;\">check_circle</i>")
    })

    $(document).on("click", ".contactInfoType2", function () {
        var Adminprofile = $(this).closest('.contact2');
        $('#SenderFullName').text(Adminprofile.find('.FullName').text());
        $('#SenderPhone').text(Adminprofile.find('.Phone').text())
        $('#SenderStreet').text(Adminprofile.find('.Street').text())
        $('#SenderAddress').text(Adminprofile.find('.Address').text())
        $('#SenderPostalDistrictCode').text(Adminprofile.find('.Address').data("district"));
        var a = $('#isCheckContactType2-' + $(this).attr('data-contactinfoid'));
        $(".is-check-contact-type-2").empty();
        validate2 = true;
        a.append("<i class=\"material-icons dp48 right\" style=\"font-size:35px;right:0px;vertical-align: middle;color: #7abd7a;\">check_circle</i>");
    })

    $(document).on("click", ".contactInfoType3", function () {
        var Adminprofile = $(this).closest('.contact3');
        $('.ReceiverFullName').text(Adminprofile.find('.FullName').text());
        $('#ReceiverPhone').text(Adminprofile.find('.Phone').text())
        $('.ReceiverStreet').text(Adminprofile.find('.Street').text())
        $('#ReceiverPostalDistrictCode').text(Adminprofile.find('.Address').data("district"));
        $('.ReceiverAddress').text(Adminprofile.find('.Address').text())
        var a = $('#isCheckContactType3-' + $(this).attr('data-contactinfoid'));
        $(".is-check-contact-type-3").empty();
        validate3 = true;
        a.append("<i class=\"material-icons dp48 right\" style=\"font-size:35px;right:0px;vertical-align: middle;color: #7abd7a;\">check_circle</i>")
    })
</script>
<script>
    var form = $(".validation-wizard").show();
    var error = true; ``
    $(document).ready(function () {
        $('#item5').focusout(function () {
            if ($(this).val() == "" || $(this).val().trim() == "") {
                $('p[name="item5"]').text('Vui lòng nhập Mã giấy hẹn')
                return;
            }
            else {
                $('#pre-load').show()
                $.ajax({
                    type: "POST",
                    url: "/giay-hen/nhap-giay-hen/thong-tin-thu-tuc/CheckAppointmentLetterCode",
                    cache: false,
                    dataType: "json",
                    data: {
                        AppointmentLetterCode: $(this).val()
                    },
                    success: function (response) {
                        error = response;
                        if (response === false)
                            $('p[name="item5"]').text('Mã giấy hẹn này đã được tạo bởi một đơn hàng trước đó, vào mục tìm kiếm để xem đơn hàng tương ứng với mã giấy hẹn này')
                        else
                            $('p[name="item5"]').text('')
                        $('#pre-load').hide()
                    },
                    error: function () {
                        $('#pre-load').hide()
                    }
                })
            }
        })
    })

    $(".validation-wizard").steps({
        headerTag: "h6",
        bodyTag: "section",
        transitionEffect: "fade",
        titleTemplate: '<span class="step">#index#</span> #title#',
        labels: {
            next: "Tiếp tục",
            previous: "Quay lại",
            finish: "Hoàn tất"
        },
        onStepChanging: function (event, currentIndex, newIndex) {
            _currentIndex = currentIndex;
            _newIndex = newIndex;
            if (currentIndex === 0) {
                if (data1.get("img") == null) {
                    $('p[name="item6"]').text('Vui lòng chọn Ảnh chụp giấy hẹn');
                    return false;
                }
                else {
                    $('p[name="item6"]').text('');
                    var data = new FormData();
                    data.append('image', data1.get('img'));
                    if (ImageData != data1.get('img')) {
                        $('#pre-load').show();
                        $.ajax({
                            type: "POST",
                            url: "http://103.104.117.175/ocr",
                            data: data,
                            contentType: false,
                            processData: false,
                            cache: false,
                            dataType: "json",
                            success: function (response) {
                                if (response.hasOwnProperty('form_id') && response.form_id != "") {
                                    $.ajax({
                                        type: "POST",
                                        url: "/giay-hen/nhap-giay-hen/thong-tin-thu-tuc/GetOCRResult",
                                        dataType: "json",
                                        cache: false,
                                        data: response,
                                        success: function (result) {
                                            console.log(result)
                                            OCRResult = result;
                                            $('#item1').val(OCRResult.PostalProvinceCode);
                                            $('#item1').formSelect();
                                            UserDistrictsID = OCRResult.PostalDistrictCode;
                                            UserAdminLocationID = OCRResult.PublicAdministrationLocationID;
                                            UserProfileID = OCRResult.ProfileID;
                                            $("#item5").val(OCRResult.AppointmentLetterCode)
                                            $("#item5").next().addClass('active')
                                            $("#item5").blur()
                                            getDistrict(OCRResult);
                                        },
                                        error: function () {
                                            $('#pre-load').hide();
                                        }
                                    }).done(function () {
                                        $('#pre-load').hide();
                                        //$('a[role="menuitem"]').eq(1).click();
                                        ImageData = data1.get('img');
                                    });
                                } else {
                                    $('#pre-load').hide();
                                }
                            },
                            error: function () {
                                $('#pre-load').hide();
                            }
                        })
                    }

                    return true;
                }
            }
            else if (currentIndex === 1 && newIndex > currentIndex) {
                var pass = true;
                if ($('#item1').val() == null) {
                    $('p[name="item1"]').text('Vui lòng chọn Thành phố');
                    pass = false;
                }
                if ($('#item2').val() == null) {
                    $('p[name="item2"]').text('Vui lòng chọn Quận/huyện')
                    pass = false;
                }
                if ($('#item3').val() == null) {
                    $('p[name="item3"]').text('Vui lòng chọn Tên cơ quan hành chính')
                    pass = false;
                }
                if ($('#item4').val() == null) {
                    $('p[name="item4"]').text('Vui lòng chọn Tên thủ tục');
                    pass = false;
                }
                if ($('#item5').val() == "" || $('#item5').val().trim() == "") {
                    $('p[name="item5"]').text('Vui lòng nhập Mã giấy hẹn')
                    pass = false;
                }
                if (pass === false || error === false)
                    return;
                else {
                    $('p[name="item1"]').text('');
                    $('p[name="item2"]').text('');
                    $('p[name="item3"]').text('');
                    $('p[name="item4"]').text('');
                    $('p[name="item5"]').text('');
                    UserInvitation.UserProvinceCode = $('#item1').val()
                    UserInvitation.PostalDistrictCode = $('#item2').val()
                    UserInvitation.UserAdminLocationID = $('#item3').val()
                    UserInvitation.UserProfileID = $('#item4').val()
                    UserInvitation.UserLetterCode = $('#item5').val()
                    $.cookie('CreateInvitation', JSON.stringify(UserInvitation), { expires: 0 });
                    $('#c').css("width", $('#myform-p-0').width());
                    return true;
                }
            }
            else if (currentIndex === 2 && !validate1 && newIndex > currentIndex) {
                toastr.error('Vui lòng chọn thông tin người yêu cầu giải quyết TTHC');
                return false;
            }
            else if (currentIndex === 3 && !validate2 && newIndex > currentIndex) {
                toastr.error('Vui lòng chọn thông tin người gửi');
                return false;
            }
            else if (currentIndex === 4 && !validate3 && newIndex > currentIndex) {
                toastr.error('Vui lòng chọn thông tin người nhận');
                return false;
            }
            else if (currentIndex === 5) {
                UserInvitation.UserOrderNote = $('#OrderNote').val()
                $.cookie('CreateInvitation', JSON.stringify(UserInvitation), { expires: 0 });
                return true;
            }
            else
                return true;
        },
        onFinishing: function (event, currentIndex) {
            $('#pre-load').show();
            var data = new FormData();
            data.append("img", data1.get("img"));
            data.append("imgName", data1.get("imgName"));
            data.append("ProfileID", $('#item4').val());
            data.append("AppointmentLetterCode", $('#item5').val());
            data.append("ProcedurerFullName", $('#ProcedurerFullName').text());
            data.append("ProcedurerPhone", $('#ProcedurerPhone').text());
            data.append("ProcedurerPostalDistrictCode", $('#ProcedurerPostalDistrictCode').text());
            data.append("ProcedurerPersonalPaperTypeID", $('#ProcedurerPersonalPaperTypeID').text())
            data.append("ProcedurerStreet", $('#ProcedurerStreet').text());
            data.append("ProcedurerPersonalPaperNumber", $('#ProcedurerPersonalPaperNumber').text());
            data.append("ProcedurerPersonalPaperIssuedDate", $('#ProcedurerPersonalPaperIssuedDate').text());
            data.append("ProcedurerPersonalPaperIssuedPlace", $('#ProcedurerPersonalPaperIssuedPlace').text());
            data.append("SenderFullName", $('#SenderFullName').text());
            data.append("SenderPhone", $('#SenderPhone').text());
            data.append("SenderPostalDistrictCode", $('#SenderPostalDistrictCode').text())
            data.append("SenderStreet", $('#SenderStreet').text());
            data.append("ReceiverFullName", $('.ReceiverFullName').eq(0).text());
            data.append("ReceiverPhone", $('#ReceiverPhone').text());
            data.append("ReceiverPostalDistrictCode", $('#ReceiverPostalDistrictCode').text())
            data.append("ReceiverStreet", $('.ReceiverStreet').eq(0).text());
            data.append("OrderNote", $('#OrderNote').val());
            $.ajax({
                type: "POST",
                url: "/don-hang/thanh-toan",
                data: data,
                processData: false,
                contentType: false,
                success: function (response) {
                    if (response.success) {
                        $.removeCookie('CreateInvitation')
                        $('#id_raw').val(response.data)
                        $('#myform').submit();
                    }
                    else {
                        errorAlert(response.message)
                        $('#pre-load').hide();
                    }
                },
                error: function (request, status, error) {
                    errorAlert("Có lỗi xảy ra");
                    $('#pre-load').hide();
                }
            });
            //return form.submit();
        },
        onFinished: function (event, currentIndex) {
            swal("Form Submitted!", "");
        }
    }), $(".validation-wizard").validate({
        ignore: "input[type=hidden]",
        errorClass: "text-danger",
        successClass: "text-success",
        highlight: function (element, errorClass) {
            $(element).removeClass(errorClass)
        },
        unhighlight: function (element, errorClass) {
            $(element).removeClass(errorClass)
        },
        errorPlacement: function (error, element) {
            error.insertAfter(element)
        },
        rules: {
            email: {
                email: !0
            }
        }
    })
</script>
<script>
    //Create by TUANKQ, THANGDV
Dropzone.options.myAwesomeDropzone = {
    paramName: "file", // The name that will be used to transfer the file
    maxFilesize: 6, // MB
    addRemoveLinks: true,
    autoProcessQueue: true,
    dictRemoveFile: 'Hủy',
    clickable: true,
    acceptedFiles: "image/jpeg,image/png,image/gif,image/jpg,image/bmp",
    maxFiles: 10,
    thumbnailWidth: null,
    thumbnailHeight: null,
    uploadMultiple: true,
    parallelUploads: 10,
    maxfilesexceeded: function() {
        var myDropzone = this;
        myDropzone.removeAllFiles();
    },
    init: function () {
        this.on("addedfile", function (file) {
            var reader = new FileReader();
            reader.onload = function (event) {
                var extension = event.target.result.split(';')[0].split('/')[1];
                if (!(extension == 'jpeg' || extension == 'png' || extension == 'gif' || extension == 'bmp' || extension == 'jpg')) {
                    $('p[name="item6"]').text('Ảnh chụp giấy hẹn chưa đúng định dạng')
                    return;
                }
                $('p[name="item6"]').text('')
                var base64String = event.target.result;
                $('#c').attr("src", base64String);
            };
            reader.readAsDataURL(file);
            if (this.files.length > 1) {
                for (var i = 0; i < this.files.length; i++){
                        this.removeFile(this.files[i]);
                }
            }
        });
        this.on("removedfile", function () {
            data1.delete("img")
            data1.delete("imgName")
        });
        this.on("thumbnail", function (file, dataUrl) {
            $('.dz-image').last().find('img').attr({ width: '100%', height: '100%' });
        }),
        this.on("success", function (file) {
            $('.dz-image').css({ "width": "100%", "height": "auto" });
        })
        var myDropzone = this;
        $("#btnUpload3").click(function (e) {
            e.preventDefault();
            myDropzone.processQueue();
        });
        this.on('sending', function (file, xhr, formData) {
            data1.append("img", file);
            data1.append("imgName", file.name)
        });
    },
    dictResponseError: "Lỗi (Code: {{statusCode}})",
    dictFileTooBig: "Kích cỡ file quá lớn ({{filesize}}MB). Kích cỡ file tối đa: {{maxFilesize}}MB ",
    dictInvalidFileType: "File không hợp lệ",
};

</script>
<script>
    function rotateRight() {
        if (data1.get("img") == null) return;
        $('#pre-load').show();
        data1.delete("img")
        var image = new Image();
        image.src = $('#c').attr("src");
        image.onload = function () {
            var canvas = document.createElement("canvas");
            var ctx = canvas.getContext("2d");
            canvas.width = image.height;
            canvas.height = image.width;
            ctx.rotate(90 * Math.PI / 180);
            ctx.translate(0, -canvas.width);
            ctx.drawImage(image, 0, 0);
            var URL = canvas.toDataURL('image/jpeg');
            $('img[data-dz-thumbnail]').attr("src", URL);
            $('#c').attr("src", URL);
            dataURItoBlob(URL);
        };
    }

    function rotateLeft() {
        if (data1.get("img") == null) return;
        $('#pre-load').show();
        data1.delete("img")
        var image = new Image();
        image.src = $('#c').attr("src");
        image.onload = function () {
            var canvas = document.createElement("canvas");
            var ctx = canvas.getContext("2d");
            canvas.width = image.height;
            canvas.height = image.width;
            ctx.rotate(270 * Math.PI / 180);
            ctx.translate(-canvas.height, 0);
            ctx.drawImage(image, 0, 0);
            var URL = canvas.toDataURL('image/jpeg');
            $('img[data-dz-thumbnail]').attr("src", canvas.toDataURL());
            $('#c').attr("src", URL);
            dataURItoBlob(URL);
        };
    }

    function dataURItoBlob(dataURI) {
        var blobBin = atob(dataURI.split(',')[1]);
        var array = [];
        for (var i = 0; i < blobBin.length; i++) {
            array.push(blobBin.charCodeAt(i));
        }
        var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
        var file = new Blob([new Uint8Array(array)], { type: mimeString });
        data1.append("img", file);
        $('#pre-load').hide();
    }
</script>
<script src="~/assets/libs/toastr/build/toastr.min.js"></script>
<script src="~/assets/extra-libs/toastr/toastr-init.js"></script>
<script src="~/CustomJS/datepicker_src/dist/js/datepicker.js"></script>
<script src="~/CustomJS/datepicker_src/dist/js/i18n/datepicker.vi.js"></script>