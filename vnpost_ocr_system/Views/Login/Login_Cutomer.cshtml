@{
    ViewBag.Title = "Login";
    Layout = "~/Views/Shared/_MasterPage.cshtml";
}
<link href="~/CustomCSS/Login/Authentication.css" rel="stylesheet" />
<link href="~/CustomCSS/UserRegister/UserRegister.css" rel="stylesheet" />



<style>
    .sdt-or-email-checkbox {
        margin-top: 20px !important;
        margin-left: 20px !important;
    }

        .sdt-or-email-checkbox * {
            padding-right: 10px !important;
        }

    .card .card-content {
        padding-top: 0px !important;
    }
</style>
<div class="row title_login">
    <div class="row">
        <div class="col l4" id="login-web">
            <div class="card">
                <div class="card-content login-content">
                    <div class="row">
                        <div class="logo login-logo col l12 s6 offset-s3">
                            <span class="db"><img src="../../assets/images/Logo.png" alt="logo"></span>
                        </div>
                        <div class="col l12 s12 m-t-5">
                            <p class="font-medium login-label">PHẦN MỀM TIẾP NHẬN HỒ SƠ HÀNH CHÍNH CÔNG</p>
                        </div>
                        <div class="col l10 offset-l2 m8 offset-m4 s12 title-label">
                            <i class="material-icons small dp48">check</i><h6>Tiện lợi</h6>
                        </div>
                        <div class="col l10 offset-l2 m8 offset-m4 s12 title-label">
                            <i class="material-icons small dp48">check</i><h6>Tin cậy</h6>
                        </div>
                        <div class="col l10 offset-l2 m8 offset-m4 s12 title-label">
                            <i class="material-icons small dp48">check</i><h6 class="">Nhanh chóng</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col l8 m12 s12 fix-padding">
            <div class="card">
                <div class="card-content login-content">
                    <div class="row">
                        <div id="login-mobile">
                            <div class="logo login-logo col l12 s6 offset-s4" id="login-mobile">
                                <span class="db"><img style="width:70%;height:40%" src="../../assets/images/Logo.png" alt="logo"></span>
                            </div>
                            <div class="col l12 s12 m-t-5" id="login-mobile">
                                <p class="font-medium login-label">PHẦN MỀM TIẾP NHẬN HỒ SƠ HÀNH CHÍNH CÔNG</p>
                            </div>
                        </div>
                        <div class="col l12 m12 s12">
                            <ul class="tabs" style="overflow-x:hidden;overflow-y:hidden">
                                <li class="tab col l6 m6 s6"><a href="#login" id="tabsss" class="@(ViewBag.messe == ""?"active":"")">Đăng nhập</a></li>
                                <li class="tab col l6 m6 s6"><a href="#register" id="tabss" class="@(ViewBag.messe != ""?"active":"")">Đăng ký</a></li>
                            </ul>
                        </div>
                        <div id="login" class="col l12">
                            <div>
                                @{
                                    var username = "";
                                    var password = "";
                                    if (ViewBag.login != null)
                                    {
                                        username = ViewBag.login.username;
                                        password = ViewBag.login.password;
                                    }
                                }
                                <div class="col l2 m2 s12">
                                    <h6>SĐT/Email</h6>
                                </div>
                                <div class="col l10 m10 offset-m3 s12">
                                    <input type="text" id="user" value="@username" class="p-l-15" placeholder="Nhập số điện thoại hoặc email">
                                </div>
                                <div class="col l10 offset-l2 m10 offset-m2 s12 input_login fix-space">
                                    <span style="color:red" id="user_failed"></span>
                                </div>
                                <div class="col l2 m2 s12 fix-space">
                                    <h6>Mật khẩu</h6>
                                </div>
                                <div class="col l10 m10 s12 input_login fix-space">
                                    <input type="password" id="pass" value="@password" class="p-l-15" placeholder="Mật khẩu từ 6 đến 32 kí từ">
                                </div>
                                <div class="col l10 offset-l2 m9 offset-m3 s12 fix-space">
                                    <span style="color:red" id="password_failed"></span>
                                </div>
                                <div class="col l12 m12 s12 fix-space">
                                    <label div class="left">
                                        <input type="checkbox" id="remem">
                                        <span>Ghi nhớ</span>
                                    </label>
                                    <label div class="right">
                                        <span class="btn-forget"><a href="javascript:void(0)">Quên mật khẩu?</a></span>
                                    </label>
                                </div>
                                <div class="col l12 s12 fix-space">
                                    <a class="waves-effect waves-light btn btn-login" style="background-color:#fcc438" onclick="Login()">Đăng nhập</a>
                                </div>
                                <div class="col l12 s12 fix-space">
                                    <a class="waves-effect waves-light btn btn-login " style="background-color:#3793c6"><div class="set-btn">Đăng nhập bằng Facebook</div><i class="fab fa-facebook-f"></i></a>
                                </div>
                                <div class="col l12 s12 fix-space">
                                    <a class="waves-effect waves-light btn btn-login" style="background-color:#d35760"><div class="set-btn">Đăng nhập bằng Google</div><i class="fab fa-google-plus-g"></i></a>
                                </div>
                            </div>

                        </div>

                        <div id="register" class="col s12">
                            <div class="auth-box">

                                <div class="row">
                                    <div class="col s3 l2 m-l-10">
                                    </div>
                                    <div id="messe" class="col s8 l9 err p-t-20">

                                    </div>
                                </div>

                                <div id="loginform">

                                    <!-- Form -->
                                    <div class="row">
                                        <div class="card">
                                            <div class="card-content">
                                                @using (Html.BeginForm("DangKi", "LoginCustomer", FormMethod.Post, new { onsubmit = "return valid()" }))
                                                {
                                                    <!-- email -->
                                                    <div class="row">
                                                        <div class="col s3 l2 m-t-20 m-l-20">
                                                            <p class="black-text">Họ tên</p>
                                                        </div>

                                                        <div class="input-field col s8 l9 m-b-0">
                                                            <input id="tbName" name="tbName" class="validate my-input" placeholder="Nhập họ tên">

                                                        </div>
                                                    </div>
                                                    <!-- email valid -->
                                                    <div class="row">
                                                        <div class="col s3 l2 m-t-20 m-l-20">
                                                        </div>
                                                        <div id="name-err" class="col s8 l9 err">
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <p style="font-size: 22px !important; color: #000000 !important;font-weight: 600" class="m-l-20">Email hoặc số điện thoại</p>
                                                    </div>
                                                    <div class="row" style="border:1px solid #d0d0d0 !important;padding-bottom: 20px; border-radius: 5px !important">
                                                        <div class="row sdt-or-email-checkbox">
                                                            <label div class="left" id="sdt-checkbox">
                                                                <input type="checkbox" id="phonecheck" class="ep-checkboxes" checked>
                                                                <span>Số điện thoại</span>
                                                            </label>
                                                            <label div class="left" id="email-checkbox">
                                                                <input type="checkbox" id="emailcheck" class="ep-checkboxes">
                                                                <span>Email</span>
                                                            </label>
                                                        </div>
                                                        <div id="checkboxphone">
                                                            <div class="row">

                                                                <div class="col s3 l2 m-t-20 m-l-20">
                                                                    <p class="black-text">SĐT</p>
                                                                </div>

                                                                <div class="input-field col s8 l5 m-b-0">
                                                                    <input id="tbPhone" name="tbPhone" class="validate my-input" placeholder="Nhập số điện thoại">

                                                                </div>

                                                                <div class="col l4 s12 m-t-10 m-b-0">
                                                                    <button class="btn-large w100 yellow-logo-bg accent-4 my-btn" type="button" style="height: 47px; margin-top: 5px;">Gửi mã xác thực</button>
                                                                </div>

                                                                <!-- email valid -->
                                                                <div class="row">
                                                                    <div class="col s3 l2 m-t-20 m-l-20">
                                                                    </div>
                                                                    <div id="phone-err" class="col s8 l9 err m-l-20">

                                                                    </div>
                                                                </div>



                                                                <div class="row">
                                                                    <div class="col s3 l2 m-t-20 m-l-20">
                                                                        <p class="black-text">Mã xác thực</p>
                                                                    </div>

                                                                    <div class="input-field col s8 l9 m-b-0">
                                                                        <input id="tbValidCodePhone" name="tbValidCodePhone" class="validate my-input" placeholder="Nhập mã xác thực">

                                                                    </div>
                                                                </div>
                                                                <!-- valid -->


                                                                <div class="row">
                                                                    <div class="col s3 l2 m-t-20 m-l-20">
                                                                    </div>
                                                                    <div id="validCodePhone-err" class="col s8 l9 err">

                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div id="checkboxemail" hidden>
                                                            <div class="row">
                                                                <div class="col s3 l2 m-t-20 m-l-20">
                                                                    <p class="black-text">Nhập Email</p>
                                                                </div>

                                                                <div class="input-field col s8 l5 m-b-0">
                                                                    <input id="tbEmail" name="tbEmail" class="validate my-input" placeholder="Nhập địa chỉ email">

                                                                </div>

                                                                <div class="col l4 s12 m-t-10 m-b-0">
                                                                    <button class="btn-large w100 yellow-logo-bg accent-4 my-btn" type="button" style="height: 47px; margin-top: 5px;">Gửi mã xác thực</button>
                                                                </div>

                                                                <!-- email valid -->
                                                                <div class="row">
                                                                    <div class="col s3 l2 m-t-20 m-l-20">
                                                                    </div>
                                                                    <div id="email-err" class="col s8 l9 err m-l-20">

                                                                    </div>
                                                                </div>
                                                            </div>


                                                            <div class="row">
                                                                <div class="col s3 l2 m-t-20 m-l-20">
                                                                    <p class="black-text">Mã xác thực</p>
                                                                </div>

                                                                <div class="input-field col s8 l9 m-b-0">
                                                                    <input id="tbValidCodeEmail" name="tbValidCodeEmail" class="validate my-input" placeholder="Nhập mã xác thực">

                                                                </div>
                                                            </div>



                                                            <!-- valid -->


                                                            <div class="row">
                                                                <div class="col s3 l2 m-t-20 m-l-20">
                                                                </div>
                                                                <div id="validCodeEmail-err" class="col s8 l9 err">

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    //
                                                    <!-- valid -->

                                                    <div class="row">
                                                        <div class="row sdt-or-email-checkbox">
                                                            <div class="col s5 l5 m-l-20">
                                                                <p class="black-text">Tỉnh thành cư trú</p>
                                                                <select id="province" onchange="getDis()">
                                                                </select>
                                                            </div>
                                                            <div class="col s5 l5 m-l-20">
                                                                <p class="black-text">Quận huyện cư trú</p>
                                                                <select id="district" name="distrint">
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col s3 l2 m-t-20 m-l-20 col-sm-offset-3">
                                                        </div>
                                                        <div id="diachi-err" class="col s8 l9 err">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col s3 l2 m-t-20 m-l-20">
                                                            <p class="black-text">Mật khẩu</p>
                                                        </div>

                                                        <div class="input-field col s8 l9 m-b-0">
                                                            <input id="tbPass" name="tbPass" type="password" class="validate my-input" placeholder="Mật khẩu từ 6 - 32 kí tự">

                                                        </div>
                                                    </div>
                                                    <!-- valid -->


                                                    <div class="row">
                                                        <div class="col s3 l2 m-t-20 m-l-20">
                                                        </div>
                                                        <div id="pass-err" class="col s8 l9 err">
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col s3 l2 m-t-20 m-l-20 m-b-0">
                                                            <p class="black-text m-b-0">Nhập lại mật khẩu</p>
                                                        </div>

                                                        <div class="input-field col s8 l9 m-b-0">
                                                            <input id="tbRePass" type="password" name="tbRePass" class="validate my-input" placeholder="Nhập lại mật khẩu">

                                                        </div>
                                                    </div>
                                                    <!-- valid -->


                                                    <div class="row">
                                                        <div class="col s3 l2 m-t-20 m-l-20">
                                                        </div>
                                                        <div id="rePass-err" class="col s8 l9 err">
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col s3 l2 m-t-20 m-l-20">
                                                            <p class="black-text">Giới tính</p>
                                                        </div>

                                                        <div class="col gender-mobile m-b-30">
                                                            <label class="offset-s2">
                                                                <input name="group1" value="1" type="radio" id="male" checked />
                                                                <span>Nam</span>
                                                            </label>
                                                            <label>
                                                                <input name="group1" value="0" type="radio" />
                                                                <span>Nữ</span>
                                                            </label>

                                                            <label class="new-line-small">
                                                                <input name="group1" value="2" type="radio" />
                                                                <span>Khác</span>
                                                            </label>
                                                        </div>

                                                        <!-- pwd -->
                                                        <div class="row m-t-40 m-b-40 m-l-20 m-r-20">
                                                            <div class="col s12">
                                                                <button class="btn-large w100 yellow-logo-bg accent-4 black-text" type="submit">Tạo tài khoản</button>
                                                            </div>
                                                        </div>

                                                    </div>
                                                }
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="text" id="tem2" value="@ViewBag.invalidcode1" hidden />
    <input type="text" id="tem" value="@ViewBag.invalidcode" hidden />
    <input type="text" id="tem1" value="@ViewBag.messe" hidden />
    <script>
        $(document).ready(function () {
            if (document.getElementById('tem').value != '') {
                $('#validCodePhone-err').text('Mã xác thực không đúng');
            }
            if (document.getElementById('tem2').value != '') {
                $('#validCodeEmail-err').text('Mã xác thực không đúng');
                $('#emailcheck').attr('checked', 'checked');
                document.getElementById('emailcheck').value = 1;
            }
            if (document.getElementById('tem1').value != '') {
                s
                $('#messe').text(document.getElementById('tem1').value);
            }
            var windowWidth = $(window).width();
            if (windowWidth < 768) {
                $(".set-btn").remove();
            }
            getPro();
            //chen1();
            //chen2();
        });

        function getDis() {
            var emp = {
                id: document.getElementById('province').value
            };
            $.ajax({
                url: "/LoginCustomer/GetDis",
                type: "POST",
                data: JSON.stringify(emp),
                contentType: "application/json;charset=utf-8",
                success: function (result) {
                    $('#district').empty();
                    var string = "<option value='' selected disabled>Quận/Huyện</option>";
                    result.forEach(function (key) {
                        string += "<option value='" + key.PostalDistrictCode + "'>" + key.PostalDistrictName + "</option>";
                    });
                    $('#district').append(string);
                    $('#district').formSelect();
                },
                error: function (errormessage) {
                }
            });
        }

        function getPro() {
            $.ajax({
                url: "/LoginCustomer/GetPro",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                success: function (result) {
                    var string = "<option value='' selected disabled>Tỉnh/Thành</option>";
                    result.forEach(function (key) {
                        string += "<option value='" + key.PostalProvinceCode + "'>" + key.PostalProvinceName + "</option>";
                    });
                    $('#province').append(string);
                    $('#province').formSelect();
                },
                error: function (errormessage) {
                }
            });
        }

        function Login() {
            var username = document.getElementById('user').value;
            var password = document.getElementById('pass').value;
            if (!username.length == 0) {
                $('#user_failed').html('');
            } else {
                $('#user_failed').html('Vui lòng nhập nhập số điện thoại hoặc email ');
                return false;
            }
            if (!password.length == 0) { $('#password_failed').html(''); }
            else {
                $('#password_failed').html('Mật khẩu không được để trống');
                return false;
            }
            $('#pre-load').show();
            var emb = {
                user: document.getElementById('user').value,
                pass: document.getElementById('pass').value,
                checkbox: $('#remem').is(":checked")
            };
            $.ajax({
                url: "/LoginCustomer/Login",
                type: "POST",
                data: JSON.stringify(emb),
                contentType: "application/json;charset=utf-8",
                success: function (result) {
                    if (result == 1) {
                        $('#user_failed').html('Số điện thoại / Email không đúng');
                    }
                    if (result == 2) {
                        $('#password_failed').html('Mật khẩu không đúng');
                    }
                    if (result == 3) {
                        window.location.href = '/';
                    }
                    $('#pre-load').hide();
                },
                error: function (errormessage) {
                    $('#pre-load').hide();
                }
            });
        }


        $(".ep-checkboxes").click(function (e) {
            var email = $("#emailcheck").is(":checked");
            var phone = $("#phonecheck").is(":checked");
            if (email === false && phone === false) {
                e.preventDefault();
            } else {
                if ($("#emailcheck").is(":checked") === true) {
                    $('#checkboxemail').show();
                } else {
                    $('#checkboxemail').hide();
                }
                if ($("#phonecheck").is(":checked") === true) {
                    $('#checkboxphone').show();
                } else {
                    $('#checkboxphone').hide();
                }
            }

        });

        //$("#btn_login").click(function () {
        //    var check = 0;
        //    if ($("#user").val() == "01234") {
        //        $("#user_failed").show();
        //        $("#password_failed").hide();
        //        check = 1;
        //    }
        //    if ($("#pass").val() == "123") {
        //        $("#user_failed").hide();
        //        $("#password_failed").show();
        //        check = 1;
        //    }
        //    if (check == 0) {
        //        window.location.href = "/tai-khoan/thong-tin-tai-khoan";
        //    }
        //});
        $(document).ready(function () {
            var windowWidth = $(window).width();
            if (windowWidth <= 1023) {
                $("#login-web").remove();
            }
            if (windowWidth > 1023) {
                $("#login-mobile").remove();
            }
        });


        function valid() {
            $('#messe').text('');
            $('#name-err').text('');
            $('#phone-err').text('');
            $('#validCodePhone-err').text('');
            $('#validCodeEmail-err').text('');
            $('#email-err').text('');
            $('#diachi-err').text('');
            $('#pass-err').text('');
            $('#rePass-err').text('');
            var name = document.getElementById('tbName').value;
            var phone = document.getElementById('tbPhone').value;
            var validCodePhone = document.getElementById('tbValidCodePhone').value;
            var validCodeEmail = document.getElementById('tbValidCodeEmail').value;
            var pro = document.getElementById('province').value;
            var dis = document.getElementById('district').value;
            var email = document.getElementById('tbEmail').value;
            var pass = document.getElementById('tbPass').value;
            var rePass = document.getElementById('tbRePass').value;
            var valid = true;

            if (name.length == 0) {

                $('#name-err').text('Vui lòng nhập tên');
                return false;
            }
            if ($("#phonecheck").is(":checked") === true) {
                if (phone.length == 0) {

                    $('#phone-err').text('Vui lòng nhập số điện thoại');
                    return false;
                }
                if (phone.length != 10 && phone.length > 0) {
                    $('#phone-err').text('Số điện thoại không tồn tại');
                    return false;
                }
                if (validCodePhone.length == 0) {

                    $('#validCodePhone-err').text('Vui lòng nhập mã xác thực');
                    return false;
                }

                if (validCodePhone.length != 6) {

                    $('#validCodePhone-err').text('Mã xác thực không đúng');
                    return false;
                }
            }
            if ($("#emailcheck").is(":checked") === true) {
                if (email.length == 0) {

                    $('#email-err').text('Vui lòng nhập email');
                    return false;
                }
                if (validCodeEmail.length == 0) {

                    $('#validCodeEmail-err').text('Vui lòng nhập mã xác thực');
                    return false;
                }

                if (validCodeEmail.length != 6) {

                    $('#validCodeEmail-err').text('Mã xác thực không đúng');
                    return false;
                }
            }
            if (document.getElementById('emailcheck').value == 1 && document.getElementById('phonecheck').value == 1) {
                $('#messe').text('Bạn cần xác thực bằng số điện thoại hoặc email để có thể đăng ký');
                return false;
            }

            if (pro == '' || dis == '') {
                $('#diachi-err').text('Vui lòng chọn nơi cư trú');
                return false;
            }

            //var isEmail = /^[a-zA-Z0-9]{1,}[@@]{1}[a-z]{1,}[.]{1}[a-z]{1,3}$/.test(email);
            //if (isEmail == false) {

            //    $('#email-err').text('Địa chỉ email không hợp lệ');
            //    return false;
            //}



            if (pass.length == 0) {

                $('#pass-err').text('Vui lòng nhập mật khẩu');
                return false;
            }
            if (pass.length < 6 || pass.length > 32) {

                $('#pass-err').text('Mật khẩu gồm 6-32 kí tự');
                return false;
            }
            if (rePass.length == 0) {

                $('#rePass-err').text('Vui lòng nhập trường nhập lại mật khẩu');
                return false;
            }
            if (rePass != pass) {

                $('#rePass-err').text('Mật khẩu nhập lại không khớp');
                return false;
            }
            return valid;
        }
    </script>
